:sourcesdir: ../../../../source

[[unique_constraint_violation_exceptions]]
==== Обработка исключений нарушения ограничений уникальности в экранах

Платформа предоставляет возможность установить уникальное сообщение для ошибки ограничения в базе данных.

Свойство <<cuba.uniqueConstraintViolationPattern,cuba.uniqueConstraintViolationPattern>> определяет регулярное выражение, отличное от стандартного, используемого для вашей базы данных. Затем этот шаблон используется обработчиком `UniqueConstraintViolationHandler`, который отлавливает нарушения ограничений уникальности.

Возможно, вам потребуется настроить это выражение для вашей СУБД, и значение его первой непустой группы будет использоваться для поиска сообщения пользователю в <<main_message_pack,главном пакете сообщений>>.

Имя индекса можно использовать для выдачи пользователю локализованного сообщения о том, для какой сущности нарушено ограничение. Для этого в главном пакете сообщений необходимо задать ключи, соответствующие именам индексов. Обратите внимание, что имя ключа должно быть написано заглавными буквами. Например:

[source, plain]
----
IDX_SEC_USER_UNIQ_LOGIN = Пользователь с таким логином уже существует
----

Так, например, если вы получили уведомление:

image::unique_constraint_message.png[align="center"]

И затем, оставив регулярное выражение по умолчанию, добавили

[source, properties]
----
IDX_DEMO_PRODUCT_UNIQ_NAME = Товар с таким именем уже существует
----

к главному пакету сообщений, вы получите следующее уведомление:

image::unique_constraint_message_2.png[align="center"]

Вы также можете полностью заменить стандартный обработчик `UniqueConstraintViolationHandler`, предоставив свой собственный <<exceptionHandlers,обработчик исключений>> с порядком `HIGHEST_PLATFORM_PRECEDENCE - 10`.
